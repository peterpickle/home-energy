{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Home Vent</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" href="{% static 'home_vent/favicon.ico' %}" sizes="any">
    <link rel="apple-touch-icon" href="{% static 'home_vent/apple-touch-icon.png' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{% static 'home_vent/main.css' %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
    function getValue(fieldName) {
        url = "get/" + fieldName;
        $.getJSON(url,
            function(value) {
                updateValueInUI(key, result[key]);
            }
        );
    }

    function getAllValues() {
        url = "getAll";
        $.getJSON(url,
            function(result) {
                for(key in result) {
                    updateValueInUI(key, result[key]);
                }
                setTimeout("getAllValues()", 2000);
            }
        );
    }

    function doAction(action) {
        url = "action/" + action;
        $.getJSON(url,
            function(response) {
                /*if (response == "ok") {
                }*/
            }
        );
    }

    window.onload = function() {
        getAllValues();

        $("img").click(function() {
            getAllValues();
        });

        $("#set_away_btn").click(function() {
            doAction("manual");
            setTimeout('doAction("ventilation_level_0")', 1000)
        });
        $("#set_manual_btn").click(function() {
            doAction("manual");
        });
        $("#set_auto_btn").click(function() {
            doAction("auto");
        });
        $("#set_ventilation_level_1_btn").click(function() {
            doAction("ventilation_level_1");
        });
        $("#set_ventilation_level_2_btn").click(function() {
            doAction("ventilation_level_3");
        });
        $("#set_ventilation_level_3_btn").click(function() {
            doAction("ventilation_level_3");
        });
    }

    function updateValueInUI(fieldName, value) {
        if (fieldName.includes("humidity") ||
            fieldName.includes("duty") ||
            fieldName.includes("flow") ||
            fieldName.includes("power_consumption")) {
            value = parseFloat(value)
        }
        $("#"+ fieldName.replace('.','_') + "_div").text(value);
    }

    </script>
</head>
<body>
    <div id="image_container_div">
        <img src="{% static 'home_vent/vent_exchange.png' %}">

        <!-- TOP -->
        <div id="comfoair_air_exhaust_temperature_div"></div>
        <div id="comfoair_air_exhaust_humidity_div"></div>
        <div id="comfoair_air_outdoor_temperature_div"></div>
        <div id="comfoair_air_outdoor_humidity_div"></div>

        <div id="comfoair_fan_exhaust_flow_div"></div>
        <div id="comfoair_fan_exhaust_duty_div"></div>
        
        <!-- MIDDLE -->
        <div id="comfoair_power_consumption_ventilation_div"></div>
        <div id="comfoair_ventilation_level_div"></div>
        <div id="comfoair_rmot_div"></div>

        <!-- BOTTOM -->
        <div id="comfoair_fan_supply_duty_div"></div>
        <div id="comfoair_fan_supply_flow_div"></div>
        
        <div id="comfoair_air_supply_temperature_div"></div>
        <div id="comfoair_air_supply_humidity_div"></div>
        <div id="comfoair_air_extract_temperature_div"></div>
        <div id="comfoair_air_extract_humidity_div"></div>
    </div>

    <br/>
    <div class="bottom_button_container">
        <div id="set_operating_mode_div" class="mode btn-group" role="group">
            <button type="button" id="set_away_btn" class="btn btn-secondary mode_button">Away</button>
            <button type="button" id="set_auto_btn" class="btn btn-secondary mode_button">Auto</button>
            <button type="button" id="set_manual_btn" class="btn btn-secondary mode_button">Manual</button>
        </div>
        <div id="set_speed_div" class="mode btn-group" role="group">
            <button type="button" id="set_ventilation_level_1_btn" class="btn btn-secondary mode_button">1</button>
            <button type="button" id="set_ventilation_level_2_btn" class="btn btn-secondary mode_button">2</button>
            <button type="button" id="set_ventilation_level_3_btn" class="btn btn-secondary mode_button">3</button>
        </div>
    </div>
</body>
</html>
